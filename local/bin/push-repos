#!/bin/bash
set -e
DIRS=$(find "$HOME" -maxdepth 1 -mindepth 1 -type d -and -not -iname '.*')

for dir in $DIRS; do
  if [ -d "$dir/.git" ]; then
    (
      set -e
      cd "$dir"
      echo "$dir"
      BASE=$(basename "$dir")
      if [[ "$BASE" == "todo" ]] ||
        [[ "$BASE" == "bills" ]] ||
        [[ "$BASE" == "scraps" ]] ||
        [[ "$BASE" == "ledger" ]] ||
        [[ "$BASE" == "notes" ]]
      then
        git push --all --quiet
      else
        read -p "Push all branches in $dir? [y/n]" -n 1 -r
        echo
        if [[ $REPLY =~ ^[Yy]$ ]]; then
          git push --all --quiet
        fi
      fi
    )
  fi
done
