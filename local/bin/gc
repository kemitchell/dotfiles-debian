#!/usr/bin/zsh
CACHE="$HOME/.github-my-repos"

if [[ ! -f "$CACHE" || $* == *--refresh* ]]
then
  github-my-repos | sort > "$CACHE"
  if [ -f "$HOME/.repos" ]; then
    cat "$HOME/.repos" >> "$CACHE"
  fi
fi

slug=$(cat "$CACHE" | selecta)
base=$(basename "$slug")

echo "$slug"

hub clone "$slug" "$base"

(
  cd "$base"
  hub issue
  git grep "TODO"
)
